<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Telecom Pro</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, doc, setDoc, collection, query, orderBy, limit, onSnapshot, deleteDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBq8wjHbbLGh5mlhujzX2b_-FJX4e2AYzk",
            authDomain: "quiz-telecom-claro.firebaseapp.com",
            projectId: "quiz-telecom-claro",
            storageBucket: "quiz-telecom-claro.firebasestorage.app",
            messagingSenderId: "64474953672",
            appId: "1:64474953672:web:58520fea1375adf49532fd"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // --- TODAS AS QUEST√ïES DOS SEUS PDFS ---
        const QUESTIONS = [
            {q: "Padr√£o de criptografia Wi-Fi mais seguro?", o: ["WEP", "WAP", "WPA", "WPA2+AES"], c: 3, t: 15},
            {q: "N√£o h√° disponibilidade de HP no tap. O que fazer?", o: ["Usar divisor", "Baixa #205 e abrir PE1", "Baixa #203", "Baixa #409"], c: 1, t: 25},
            {q: "Intensidade de sinal Wi-Fi ideal (Analyzer)?", o: ["-10 a -70 dBm", "0 a +12 dBm", "40 a 52 dBmv", "-80 a -100 dBm"], c: 0, t: 20},
            {q: "Inclina√ß√£o da furadeira para furos externos?", o: ["15¬∞ para cima", "Reto", "15¬∞ para baixo", "45¬∞ para baixo"], c: 2, t: 15},
            {q: "N√≠veis na sa√≠da tap do DC 06 (Entrada 15/12)?", o: ["10/8", "12.5/9.5", "15/12", "9/6"], c: 1, t: 30},
            {q: "N√≠veis OUT/TAP no DC 12 (Entrada 19)?", o: ["16/7", "17/8", "18/7", "19/8"], c: 2, t: 30},
            {q: "O que acontece ao amassar o cabo?", o: ["Mais blindagem", "Altera imped√¢ncia", "Invers√£o de tilt", "Satura frequ√™ncia"], c: 1, t: 20},
            {q: "O que √© PIP?", o: ["Ver sinal canal 270", "Janela pequena com outro canal", "Compartilhar arquivos", "Som de alerta"], c: 1, t: 20},
            {q: "TV 4K Ultra HD conectada via Wi-Fi. Qual rede usar?", o: ["2.4 GHz", "5 GHz (Maior banda)", "Cabo apenas", "Ambas juntas"], c: 1, t: 25},
            {q: "O que √© REPLAY TV?", o: ["Gravar NOW", "Recome√ßar evento atual / at√© 7 dias", "Repetir gols", "Assistir offline"], c: 1, t: 25},
            {q: "Melhor qualidade de sinal Digital?", o: ["PS 100% / QS 100% / BER -5", "PS 60% / QS 100% / BER -8", "PS 90% / QS 70% / BER -7", "PS 95% / QS 70% / BER -6"], c: 1, t: 25},
            {q: "O que √© BER?", o: ["Erro de bit", "Erro de modula√ß√£o", "Erro de sinal", "Erro de rede"], c: 0, t: 15},
            {q: "Conte√∫do gravado na nuvem fica dispon√≠vel por?", o: ["30 dias", "45 dias", "90 dias", "180 dias"], c: 2, t: 15},
            {q: "Caractere hexadecimal (F) na URA?", o: ["*6", "*06", "#6", "6"], c: 0, t: 15},
            {q: "O que √© TRACERT?", o: ["Configura Firewall", "Teste de rota / lentid√£o", "Teste de velocidade", "Antiv√≠rus"], c: 1, t: 20},
            {q: "Padr√£o Wi-Fi com maior taxa de transmiss√£o?", o: ["n", "b", "g", "ac"], c: 3, t: 15},
            {q: "Comando para renovar IP?", o: ["ipconfig/all", "ipconfig/release", "ipconfig/renew", "chkdsk"], c: 2, t: 15},
            {q: "IP de Decoder ONLINE inicia em?", o: ["10.", "168.", "189.", "192."], c: 0, t: 20},
            {q: "7,5MBps equivale a qual velocidade contratada?", o: ["12 Mbps", "60 Mbps", "120 Mbps", "240 Mbps"], c: 1, t: 30},
            {q: "Um IP Nateado (CGNAT) come√ßa com?", o: ["192.", "100.", "255.", "10.10"], c: 1, t: 15}
        ];

        let cur = 0, score = 0, timer, timeLeft, pName = "";

        window.init = () => {
            pName = document.getElementById('p-name').value;
            if(!pName) return alert("Digite seu nome!");
            document.getElementById('setup').classList.add('hidden');
            document.getElementById('quiz').classList.remove('hidden');
            loadQ();
        };

        function loadQ() {
            if(cur >= QUESTIONS.length) return finish();
            const q = QUESTIONS[cur];
            timeLeft = q.t;
            document.getElementById('q-info').innerText = `Quest√£o ${cur+1}/${QUESTIONS.length}`;
            document.getElementById('q-text').innerText = q.q;
            const box = document.getElementById('opts');
            box.innerHTML = "";
            q.o.forEach((opt, i) => {
                const b = document.createElement('button');
                b.className = "btn";
                b.innerText = opt;
                b.onclick = () => select(i);
                box.appendChild(b);
            });
            runTimer();
        }

        function runTimer() {
            const f = document.getElementById('t-fill');
            f.style.width = "100%";
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                f.style.width = (timeLeft/QUESTIONS[cur].t*100) + "%";
                if(timeLeft <= 0) select(-1);
            }, 1000);
        }

        async function select(idx) {
            clearInterval(timer);
            if(idx === QUESTIONS[cur].c) score += (100 + (timeLeft * 10));
            cur++;
            loadQ();
        }

        async function finish() {
            document.getElementById('quiz').classList.add('hidden');
            document.getElementById('result').classList.remove('hidden');
            document.getElementById('final-msg').innerText = `${pName}, total: ${score} pts!`;
            
            // SALVAR NO FIREBASE
            await setDoc(doc(db, "ranking", pName + "_" + Date.now()), { name: pName, score: score });
        }

        // ATUALIZA√á√ÉO DO RANKING EM TEMPO REAL (Para o Tel√£o)
        const qRank = query(collection(db, "ranking"), orderBy("score", "desc"), limit(10));
        onSnapshot(qRank, (snap) => {
            const list = document.getElementById('ranking-list');
            list.innerHTML = "";
            snap.forEach((doc) => {
                const d = doc.data();
                list.innerHTML += `<li><span>${d.name}</span> <b>${d.score}</b></li>`;
            });
        });

        window.resetRanking = async () => {
            if(prompt("Senha:") === "admin123") {
                const querySnapshot = await getDocs(collection(db, "ranking"));
                querySnapshot.forEach(async (d) => { await deleteDoc(doc(db, "ranking", d.id)); });
                alert("Ranking limpo!");
            }
        };
    </script>
    <style>
        :root { --red: #e31a1c; --bg: #f8f9fa; }
        body { font-family: sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 10px; }
        .card { width: 100%; max-width: 450px; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); text-align: center; }
        .btn { display: block; width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; cursor: pointer; background: #fff; font-size: 15px; }
        .btn:hover { background: #f0f0f0; }
        .timer-bar { height: 6px; background: #eee; border-radius: 3px; margin: 10px 0; overflow: hidden; }
        .timer-fill { height: 100%; background: var(--red); width: 100%; transition: 1s linear; }
        .hidden { display: none; }
        #ranking-list { list-style: none; padding: 0; text-align: left; }
        #ranking-list li { padding: 8px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
    </style>
</head>
<body>
    <div id="setup" class="card">
        <h1>üèÜ Quiz Telecom</h1>
        <input type="text" id="p-name" placeholder="Seu Nome" style="width: 80%; padding: 10px; margin-bottom: 15px;">
        <button class="btn" style="background: var(--red); color: #fff;" onclick="init()">INICIAR</button>
    </div>

    <div id="quiz" class="card hidden">
        <div id="q-info"></div>
        <div class="timer-bar"><div id="t-fill" class="timer-fill"></div></div>
        <h3 id="q-text"></h3>
        <div id="opts"></div>
    </div>

    <div id="result" class="card hidden">
        <h2 id="final-msg"></h2>
        <h4>üìä Ranking Global (Tempo Real)</h4>
        <ul id="ranking-list"></ul>
        <button class="btn" onclick="location.reload()">Jogar Novamente</button>
        <button onclick="resetRanking()" style="font-size: 10px; color: #ccc; background: none; border: none; margin-top: 20px;">Resetar Dados</button>
    </div>
</body>
</html>
