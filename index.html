<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Telecom Pro - Master</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
        import { getFirestore, doc, setDoc, collection, query, orderBy, limit, onSnapshot, deleteDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBq8wjHbbLGh5mlhujzX2b_-FJX4e2AYzk",
            authDomain: "quiz-telecom-claro.firebaseapp.com",
            projectId: "quiz-telecom-claro",
            storageBucket: "quiz-telecom-claro.firebasestorage.app",
            messagingSenderId: "64474953672",
            appId: "1:64474953672:web:58520fea1375adf49532fd"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        const QUESTIONS = [
            {q: "Padr√£o de criptografia Wi-Fi mais seguro?", o: ["WEP", "WAP", "WPA", "WPA2+AES"], c: 3, t: 15, e: "WPA2+AES √© o padr√£o atual de mercado para seguran√ßa residencial."},
            {q: "N√£o h√° disponibilidade de HP no tap. O que fazer?", o: ["Usar divisor", "Baixa #205 e abrir PE1", "Baixa #203", "Baixa #409"], c: 1, t: 25, e: "C√≥digo #205 indica falta de disponibilidade f√≠sica no TAP."},
            {q: "Intensidade de sinal Wi-Fi ideal (Analyzer)?", o: ["-10 a -70 dBm", "0 a +12 dBm", "40 a 52 dBmv", "-80 a -100 dBm"], c: 0, t: 20, e: "Sinais abaixo de -70 dBm causam instabilidade e lentid√£o."},
            {q: "Inclina√ß√£o da furadeira para furos externos?", o: ["15¬∞ para cima", "Reto", "15¬∞ para baixo", "45¬∞ para baixo"], c: 2, t: 15, e: "A inclina√ß√£o para baixo evita que a √°gua da chuva entre na resid√™ncia."},
            {q: "N√≠veis na sa√≠da tap do DC 06 (Entrada 15/12)?", o: ["10/8", "12.5/9.5", "15/12", "9/6"], c: 1, t: 30, e: "O DC 06 retira 6dB no TAP e perde cerca de 2.5dB na sa√≠da OUT."},
            {q: "N√≠veis OUT/TAP no DC 12 (Entrada 19)?", o: ["16/7", "17/8", "18/7", "19/8"], c: 2, t: 30, e: "O DC 12 atenua 12dB no TAP e apenas 1dB na sa√≠da OUT."},
            {q: "O que acontece ao amassar o cabo?", o: ["Mais blindagem", "Altera imped√¢ncia", "Invers√£o de tilt", "Satura frequ√™ncia"], c: 1, t: 20, e: "Amassados rompem a geometria do cabo, alterando a imped√¢ncia (75 ohms)."},
            {q: "O que √© PIP?", o: ["Ver sinal canal 270", "Janela pequena com outro canal", "Compartilhar arquivos", "Som de alerta"], c: 1, t: 20, e: "Picture-in-Picture permite assistir dois canais ao mesmo tempo."},
            {q: "TV 4K Ultra HD conectada via Wi-Fi. Qual rede usar?", o: ["2.4 GHz", "5 GHz (Maior banda)", "Cabo apenas", "Ambas juntas"], c: 1, t: 25, e: "A rede 5GHz possui maior largura de banda para v√≠deos em 4K."},
            {q: "O que √© REPLAY TV?", o: ["Gravar NOW", "Recome√ßar evento atual / at√© 7 dias", "Repetir gols", "Assistir offline"], c: 1, t: 25, e: "Permite recome√ßar programas que j√° come√ßaram ou assistir o que passou."},
            {q: "Melhor qualidade de sinal Digital?", o: ["PS 100% / QS 100% / BER -5", "PS 60% / QS 100% / BER -8", "PS 90% / QS 70% / BER -7", "PS 95% / QS 70% / BER -6"], c: 1, t: 25, e: "QS 100% e BER -8 (ou maior) indicam sinal sem erros de bit."},
            {q: "O que √© BER?", o: ["Erro de bit", "Erro de modula√ß√£o", "Erro de sinal", "Erro de rede"], c: 0, t: 15, e: "Bit Error Rate: mede a quantidade de erros na transmiss√£o digital."},
            {q: "Conte√∫do gravado na nuvem fica dispon√≠vel por?", o: ["30 dias", "45 dias", "90 dias", "180 dias"], c: 2, t: 15, e: "As grava√ß√µes expiram automaticamente ap√≥s 3 meses (90 dias)."},
            {q: "Caractere hexadecimal (F) na URA?", o: ["*6", "*06", "#6", "6"], c: 0, t: 15, e: "O c√≥digo *6 √© usado para representar o caractere F no sistema."},
            {q: "O que √© TRACERT?", o: ["Configura Firewall", "Teste de rota / lentid√£o", "Teste de velocidade", "Antiv√≠rus"], c: 1, t: 20, e: "Mostra o caminho dos pacotes e onde est√° ocorrendo o atraso (lat√™ncia)."},
            {q: "Padr√£o Wi-Fi com maior taxa de transmiss√£o?", o: ["n", "b", "g", "ac"], c: 3, t: 15, e: "O padr√£o 802.11ac √© superior aos padr√µes b/g/n."},
            {q: "Comando para renovar IP?", o: ["ipconfig/all", "ipconfig/release", "ipconfig/renew", "chkdsk"], c: 2, t: 15, e: "O /renew solicita um novo endere√ßo ao servidor DHCP."},
            {q: "IP de Decoder ONLINE inicia em?", o: ["10.", "168.", "189.", "192."], c: 0, t: 20, e: "A rede de ger√™ncia dos decoders utiliza a faixa 10.x.x.x."},
            {q: "7,5MBps equivale a qual velocidade contratada?", o: ["12 Mbps", "60 Mbps", "120 Mbps", "240 Mbps"], c: 1, t: 30, e: "Multiplicamos 7,5 por 8 (bits) para chegar aos 60 Mbps."},
            {q: "Um IP Nateado (CGNAT) come√ßa com?", o: ["192.", "100.", "255.", "10.10"], c: 1, t: 15, e: "A faixa 100.64.x.x √© reservada para Carrier Grade NAT."},
            {q: "Atenua√ß√£o de um Splitter de 2 vias?", o: ["-3.5 dB", "-7.0 dB", "-1.0 dB", "-12 dB"], c: 0, t: 15, e: "Um divisor de 2 vias divide o sinal ao meio, perdendo 3.5dB em cada lado."},
            {q: "O que √© AutoHit?", o: ["Sinal de Wi-Fi", "Envio autom√°tico de HIT (SD, HD, HDMAX)", "Teste de velocidade", "Resreset do modem"], c: 1, t: 20, e: "Comando autom√°tico para ativar pacotes de canais no decoder."},
            {q: "Canal para valida√ß√£o de retorno e endere√ß√°veis?", o: ["Canal 270", "Canal 262", "Canal 500", "Canal 1"], c: 1, t: 15, e: "O 262 √© o canal t√©cnico para testes de comunica√ß√£o bidirecional."},
            {q: "Barreiras que pouco interferem no Wi-Fi?", o: ["Espelhos", "Madeira e Gesso", "Aqu√°rios", "Lajes"], c: 1, t: 15, e: "Materiais densos ou met√°licos barram o sinal; madeira √© mais 'transparente'."},
            {q: "O que √© DOCSIS?", o: ["Cabo de rede", "Interface de dados via cabo", "Tipo de decodificador", "Marca de roteador"], c: 1, t: 15, e: "Data Over Cable Service Interface Specification - o padr√£o do cabo modem."},
            {q: "Update ID 1 significa que o decoder possui?", o: ["Apenas SD", "Alta defini√ß√£o e NOW", "Somente r√°dio", "Bloqueio de sinal"], c: 1, t: 20, e: "Identifica equipamentos capazes de rodar conte√∫dos HD e sob demanda."},
            {q: "Site oficial para teste de velocidade Claro?", o: ["fast.com", "speedtest.net", "brasilbandalarga.com.br", "claro.com.br"], c: 2, t: 15, e: "√â o site oficial homologado pela Anatel para medi√ß√µes oficiais."},
            {q: "Fun√ß√£o 'Autodesligar' do decoder deve ser?", o: ["Sempre desativada", "Mantida (para atualiza√ß√µes)", "Usada s√≥ de dia", "Configurada para 1h"], c: 1, t: 20, e: "O autodesligar garante que o decoder entre em standby e receba updates."},
            {q: "Na sa√≠da de um Splitter de 3 vias (balanceado), a perda √©?", o: ["-3.5 dB", "-4.8 dB", "-7.0 dB", "-12 dB"], c: 2, t: 20, e: "Splitters de 3 vias balanceados perdem 7dB em cada sa√≠da."},
            {q: "Onde o EMTA deve ser instalado preferencialmente?", o: ["No ch√£o", "No s√≥t√£o", "C√¥modo central (cobertura 80%)", "Dentro de arm√°rios"], c: 2, t: 20, e: "A centraliza√ß√£o reduz √°reas de sombra e melhora a cobertura Wi-Fi."},
            {q: "Qual rede Wi-Fi sofre menos interfer√™ncia?", o: ["2.4 GHz", "5 GHz", "AM", "FM"], c: 1, t: 15, e: "A rede 5GHz tem mais canais dispon√≠veis e menos aparelhos interferindo."},
            {q: "Para fixar o cabo em paredes de gesso usa-se?", o: ["Prego", "Rebite", "Bucha e Parafuso", "Fita adesiva"], c: 2, t: 15, e: "Gesso exige fixa√ß√£o mec√¢nica adequada para n√£o soltar com o tempo."},
            {q: "O que deve ser oferecido no final do atendimento?", o: ["Nada", "Desconto", "NOW, Controle e Minha Claro", "Outra visita"], c: 2, t: 20, e: "Encantar o cliente mostrando as facilidades do ecossistema Claro."}
        ];

        let cur = 0, score = 0, timer, timeLeft, pName = "";

        window.init = () => {
            pName = document.getElementById('p-name').value;
            if(!pName) return alert("Digite seu nome!");
            document.getElementById('setup').classList.add('hidden');
            document.getElementById('quiz').classList.remove('hidden');
            loadQ();
        };

        function loadQ() {
            if(cur >= QUESTIONS.length) return finish();
            const q = QUESTIONS[cur];
            timeLeft = q.t;
            document.getElementById('q-info').innerText = `Quest√£o ${cur+1}/${QUESTIONS.length}`;
            document.getElementById('q-text').innerText = q.q;
            document.getElementById('explanation').classList.add('hidden');
            const box = document.getElementById('opts');
            box.innerHTML = "";
            q.o.forEach((opt, i) => {
                const b = document.createElement('button');
                b.className = "btn";
                b.innerText = opt;
                b.onclick = () => select(i, b);
                box.appendChild(b);
            });
            runTimer();
        }

        function runTimer() {
            const f = document.getElementById('t-fill');
            f.style.width = "100%";
            clearInterval(timer);
            timer = setInterval(() => {
                timeLeft--;
                f.style.width = (timeLeft/QUESTIONS[cur].t*100) + "%";
                if(timeLeft <= 0) select(-1, null);
            }, 1000);
        }

        function select(idx, clickedBtn) {
            clearInterval(timer);
            const correctIdx = QUESTIONS[cur].c;
            const btns = document.querySelectorAll('.btn');
            
            // Desabilita bot√µes para evitar duplo clique
            btns.forEach(b => b.style.pointerEvents = "none");

            if(idx === correctIdx) {
                // ACERTOU
                clickedBtn.classList.add('correct');
                score += (100 + (timeLeft * 10));
                confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
            } else {
                // ERROU
                if(clickedBtn) clickedBtn.classList.add('wrong');
                btns[correctIdx].classList.add('correct'); // Mostra a certa
            }

            // Mostra explica√ß√£o
            const expBox = document.getElementById('explanation');
            expBox.innerText = QUESTIONS[cur].e;
            expBox.classList.remove('hidden');

            cur++;
            setTimeout(loadQ, 3500); // 3.5 segundos para ler a explica√ß√£o
        }

        async function finish() {
            document.getElementById('quiz').classList.add('hidden');
            document.getElementById('result').classList.remove('hidden');
            document.getElementById('final-msg').innerText = `${pName}, total: ${score} pts!`;
            await setDoc(doc(db, "ranking", pName + "_" + Date.now()), { name: pName, score: score });
        }

        const qRank = query(collection(db, "ranking"), orderBy("score", "desc"), limit(10));
        onSnapshot(qRank, (snap) => {
            const list = document.getElementById('ranking-list');
            list.innerHTML = "";
            snap.forEach((doc) => {
                const d = doc.data();
                list.innerHTML += `<li><span>${d.name}</span> <b>${d.score}</b></li>`;
            });
        });

        window.resetRanking = async () => {
            if(prompt("Senha:") === "admin123") {
                const querySnapshot = await getDocs(collection(db, "ranking"));
                querySnapshot.forEach(async (d) => { await deleteDoc(doc(db, "ranking", d.id)); });
                alert("Ranking limpo!");
            }
        };
    </script>
    <style>
        :root { --red: #e31a1c; --bg: #f0f2f5; --green: #28a745; --pink: #ff69b4; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); display: flex; justify-content: center; padding: 10px; }
        .card { width: 100%; max-width: 480px; background: #fff; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); text-align: center; }
        .btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #eee; border-radius: 12px; cursor: pointer; background: #fff; font-size: 16px; font-weight: 600; transition: 0.3s; }
        .correct { background: var(--green) !important; color: white !important; border-color: var(--green) !important; transform: scale(1.02); }
        .wrong { background: var(--pink) !important; color: white !important; border-color: var(--pink) !important; }
        .timer-bar { height: 8px; background: #eee; border-radius: 4px; margin: 15px 0; overflow: hidden; }
        .timer-fill { height: 100%; background: var(--red); width: 100%; transition: 1s linear; }
        .explanation-box { background: #fff9c4; padding: 10px; border-radius: 8px; margin-top: 15px; font-size: 14px; color: #555; border-left: 5px solid #fbc02d; }
        .hidden { display: none; }
        #ranking-list { list-style: none; padding: 0; text-align: left; }
        #ranking-list li { padding: 12px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; background: #fdfdfd; margin-bottom: 5px; border-radius: 5px; }
        h1 { color: var(--red); margin-bottom: 5px; }
        .logo { width: 80px; margin-bottom: 15px; }
    </style>
</head>
<body>
    <div id="setup" class="card">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/a/af/Claro_logo.svg/1200px-Claro_logo.svg.png" class="logo">
        <h1>DESAFIO T√âCNICO</h1>
        <p>Mostre que voc√™ √© fera no campo!</p>
        <input type="text" id="p-name" placeholder="Digite seu Nome" style="width: 85%; padding: 12px; margin-bottom: 20px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px;">
        <button class="btn" style="background: var(--red); color: #fff; border: none;" onclick="init()">COME√áAR AGORA</button>
    </div>

    <div id="quiz" class="card hidden">
        <div id="q-info" style="color: #888; font-weight: bold;"></div>
        <div class="timer-bar"><div id="t-fill" class="timer-fill"></div></div>
        <h2 id="q-text" style="margin-bottom: 20px; color: #333;"></h2>
        <div id="opts"></div>
        <div id="explanation" class="explanation-box hidden"></div>
    </div>

    <div id="result" class="card hidden">
        <h2>üèÜ RESULTADO FINAL</h2>
        <h1 id="final-msg" style="font-size: 2rem;"></h1>
        <hr>
        <h4>üìä TOP 10 RANKING</h4>
        <ul id="ranking-list"></ul>
        <button class="btn" onclick="location.reload()">Jogar Novamente</button>
        <button onclick="resetRanking()" style="font-size: 10px; color: #ccc; background: none; border: none; margin-top: 30px; cursor: pointer;">Limpar Ranking (Admin)</button>
    </div>
</body>
</html>
